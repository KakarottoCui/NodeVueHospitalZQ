import{q as e,z as a,a1 as t,r as n,a as s,bG as o,ar as r,k as i,a2 as l}from"./index-ab69a018.js";import{E as c}from"./el-message-box-7b433714.js";import"./el-button-5f0a8970.js";import"./el-input-5d13ef5f.js";import"./el-overlay-1d787c8f.js";const{t:u}=i(),g=i=>{const g=e({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(null==i?void 0:i.defaultParams)||{}},loading:!0,currentRow:null}),p=a((()=>({...g.params,pageSize:g.pageSize,pageIndex:g.currentPage})));t((()=>g.currentPage),(()=>{w.getList()})),t((()=>g.pageSize),(()=>{1===g.currentPage||(g.currentPage=1),w.getList()}));const m=n(),d=n(),v=async()=>{await l();const e=s(m);return e},P=async e=>{if(await((null==i?void 0:i.delListApi)&&(null==i?void 0:i.delListApi(e)))){r.success(u("common.delSuccess"));const a=(g.total%g.pageSize===e.length||1===g.pageSize)&&g.currentPage>1?g.currentPage-1:g.currentPage;g.currentPage=a,w.getList()}},w={getList:async()=>{var e;g.loading=!0;const a=await(null==i?void 0:i.getListApi(s(p)).finally((()=>{g.loading=!1})));a&&(g.tableList=o(a.data||{},null==i?void 0:i.response.list),g.total=o(a.data||{},null==(e=null==i?void 0:i.response)?void 0:e.total)||0)},setProps:async(e={})=>{const a=await v();null==a||a.setProps(e)},setColumn:async e=>{const a=await v();null==a||a.setColumn(e)},getSelections:async()=>{const e=await v();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{g.currentPage=1,g.params=Object.assign(g.params,{pageSize:g.pageSize,pageIndex:g.currentPage,...e}),w.getList()},delList:async(e,a,t=!0)=>{const n=await v();if(a){if(!(null==n?void 0:n.selections.length))return void r.warning(u("common.delNoData"))}else if(!g.currentRow)return void r.warning(u("common.delNoData"));t?c.confirm(u("common.delMessage"),u("common.delWarning"),{confirmButtonText:u("common.delOk"),cancelButtonText:u("common.delCancel"),type:"warning"}).then((async()=>{await P(e)})):await P(e)}};return(null==i?void 0:i.props)&&w.setProps(i.props),{register:(e,a)=>{m.value=e,d.value=s(a)},elTableRef:d,tableObject:g,methods:w}};export{g as u};
