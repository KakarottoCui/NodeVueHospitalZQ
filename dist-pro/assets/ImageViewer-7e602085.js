import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9ec610e6.js";import{Q as a,v as t,R as s,S as n,U as o,d as i,V as l,W as u,X as r,Y as c,y as d,Z as m,r as f,$ as p,a0 as v,z as g,a1 as b,a2 as k,N as w,o as h,h as _,g as y,w as x,e as I,n as C,a as z,a3 as O,a4 as j,B as T,E as N,a5 as L,c as A,F as V,a6 as E,a7 as R,a8 as X,a9 as Y,A as B,aa as D,ab as M,L as W,ac as $,ad as F,C as S,i as Z,ae as P,_ as G,af as H,ag as K,ah as Q,D as U,ai as q,aj as J,ak as ee,al as ae,K as te,t as se,k as ne}from"./index-ab69a018.js";import{d as oe}from"./debounce-9059d122.js";import{E as ie}from"./el-button-5f0a8970.js";import"./el-card-a9d60764.js";import"./el-popper-2ba03ef0.js";import"./constants-136ce4ac.js";import"./use-form-item-da890dc1.js";import"./use-form-common-props-5bbac68f.js";function le(e,t,s){var n=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(s)&&(n="leading"in s?!!s.leading:n,o="trailing"in s?!!s.trailing:o),oe(e,t,{leading:n,maxWait:t,trailing:o})}const ue=t({urlList:{type:s(Array),default:()=>n([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),re={close:()=>!0,switch:e=>o(e)},ce=["src"],de=i({name:"ElImageViewer"});const me=U(G(i({...de,props:ue,emits:re,setup(e,{expose:a,emit:t}){const s=e,n={CONTAIN:{name:"contain",icon:l(u)},ORIGINAL:{name:"original",icon:l(r)}},{t:i}=c(),G=d("image-viewer"),{nextZIndex:U}=m(),q=f(),J=f([]),ee=p(),ae=f(!0),te=f(s.initialIndex),se=v(n.CONTAIN),ne=f({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),oe=g((()=>{const{urlList:e}=s;return e.length<=1})),ie=g((()=>0===te.value)),ue=g((()=>te.value===s.urlList.length-1)),re=g((()=>s.urlList[te.value])),de=g((()=>{const{scale:e,deg:a,offsetX:t,offsetY:s,enableTransition:o}=ne.value;let i=t/e,l=s/e;switch(a%360){case 90:case-270:[i,l]=[l,-i];break;case 180:case-180:[i,l]=[-i,-l];break;case 270:case-90:[i,l]=[-l,i]}const u={transform:`scale(${e}) rotate(${a}deg) translate(${i}px, ${l}px)`,transition:o?"transform .3s":""};return se.value.name===n.CONTAIN.name&&(u.maxWidth=u.maxHeight="100%"),u})),me=g((()=>o(s.zIndex)?s.zIndex:U()));function fe(){ee.stop(),t("close")}function pe(){ae.value=!1}function ve(e){ae.value=!1,e.target.alt=i("el.image.error")}function ge(e){if(ae.value||0!==e.button||!q.value)return;ne.value.enableTransition=!1;const{offsetX:a,offsetY:t}=ne.value,s=e.pageX,n=e.pageY,o=le((e=>{ne.value={...ne.value,offsetX:a+e.pageX-s,offsetY:t+e.pageY-n}})),i=H(document,"mousemove",o);H(document,"mouseup",(()=>{i()})),e.preventDefault()}function be(){ne.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ke(){if(ae.value)return;const e=Q(n),a=Object.values(n),t=se.value.name,s=(a.findIndex((e=>e.name===t))+1)%e.length;se.value=n[e[s]],be()}function we(e){const a=s.urlList.length;te.value=(e+a)%a}function he(){ie.value&&!s.infinite||we(te.value-1)}function _e(){ue.value&&!s.infinite||we(te.value+1)}function ye(e,a={}){if(ae.value)return;const{zoomRate:t,rotateDeg:n,enableTransition:o}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":ne.value.scale>.2&&(ne.value.scale=Number.parseFloat((ne.value.scale/t).toFixed(3)));break;case"zoomIn":ne.value.scale<7&&(ne.value.scale=Number.parseFloat((ne.value.scale*t).toFixed(3)));break;case"clockwise":ne.value.deg+=n;break;case"anticlockwise":ne.value.deg-=n}ne.value.enableTransition=o}return b(re,(()=>{k((()=>{const e=J.value[0];(null==e?void 0:e.complete)||(ae.value=!0)}))})),b(te,(e=>{be(),t("switch",e)})),w((()=>{var e,a;!function(){const e=le((e=>{switch(e.code){case K.esc:s.closeOnPressEscape&&fe();break;case K.space:ke();break;case K.left:he();break;case K.up:ye("zoomIn");break;case K.right:_e();break;case K.down:ye("zoomOut")}})),a=le((e=>{ye((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})}));ee.run((()=>{H(document,"keydown",e),H(document,"wheel",a)}))}(),null==(a=null==(e=q.value)?void 0:e.focus)||a.call(e)})),a({setActiveItem:we}),(e,a)=>(h(),_(P,{to:"body",disabled:!e.teleported},[y(Z,{name:"viewer-fade",appear:""},{default:x((()=>[I("div",{ref_key:"wrapper",ref:q,tabindex:-1,class:C(z(G).e("wrapper")),style:O({zIndex:z(me)})},[I("div",{class:C(z(G).e("mask")),onClick:a[0]||(a[0]=j((a=>e.hideOnClickModal&&fe()),["self"]))},null,2),T(" CLOSE "),I("span",{class:C([z(G).e("btn"),z(G).e("close")]),onClick:fe},[y(z(N),null,{default:x((()=>[y(z(L))])),_:1})],2),T(" ARROW "),z(oe)?T("v-if",!0):(h(),A(V,{key:0},[I("span",{class:C([z(G).e("btn"),z(G).e("prev"),z(G).is("disabled",!e.infinite&&z(ie))]),onClick:he},[y(z(N),null,{default:x((()=>[y(z(E))])),_:1})],2),I("span",{class:C([z(G).e("btn"),z(G).e("next"),z(G).is("disabled",!e.infinite&&z(ue))]),onClick:_e},[y(z(N),null,{default:x((()=>[y(z(R))])),_:1})],2)],64)),T(" ACTIONS "),I("div",{class:C([z(G).e("btn"),z(G).e("actions")])},[I("div",{class:C(z(G).e("actions__inner"))},[y(z(N),{onClick:a[1]||(a[1]=e=>ye("zoomOut"))},{default:x((()=>[y(z(X))])),_:1}),y(z(N),{onClick:a[2]||(a[2]=e=>ye("zoomIn"))},{default:x((()=>[y(z(Y))])),_:1}),I("i",{class:C(z(G).e("actions__divider"))},null,2),y(z(N),{onClick:ke},{default:x((()=>[(h(),_(B(z(se).icon)))])),_:1}),I("i",{class:C(z(G).e("actions__divider"))},null,2),y(z(N),{onClick:a[3]||(a[3]=e=>ye("anticlockwise"))},{default:x((()=>[y(z(D))])),_:1}),y(z(N),{onClick:a[4]||(a[4]=e=>ye("clockwise"))},{default:x((()=>[y(z(M))])),_:1})],2)],2),T(" CANVAS "),I("div",{class:C(z(G).e("canvas"))},[(h(!0),A(V,null,W(e.urlList,((e,a)=>$((h(),A("img",{ref_for:!0,ref:e=>J.value[a]=e,key:e,src:e,style:O(z(de)),class:C(z(G).e("img")),onLoad:pe,onError:ve,onMousedown:ge},null,46,ce)),[[F,a===te.value]]))),128))],2),S(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),fe=i({__name:"ImageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:q.number.def(200),initialIndex:q.number.def(0),infinite:q.bool.def(!0),hideOnClickModal:q.bool.def(!1),appendToBody:q.bool.def(!1),show:q.bool.def(!1)},setup(e){const a=e,t=g((()=>{const e={...a};return delete e.show,e})),s=f(a.show),n=()=>{s.value=!1};return(e,a)=>s.value?(h(),_(z(me),J({key:0},z(t),{onClose:n}),null,16)):T("",!0)}});let pe=null;const ve=i({__name:"ImageViewer",setup(a){const{t:t}=ne(),s=()=>{!function(e){if(!ee)return;const{urlList:a,initialIndex:t=0,infinite:s=!0,hideOnClickModal:n=!1,appendToBody:o=!1,zIndex:i=2e3,show:l=!0}=e,u={},r=document.createElement("div");u.urlList=a,u.initialIndex=t,u.infinite=s,u.hideOnClickModal=n,u.appendToBody=o,u.zIndex=i,u.show=l,document.body.appendChild(r),pe=y(fe,u),ae(pe,r)}({urlList:["https://img1.baidu.com/it/u=657828739,1486746195&fm=26&fmt=auto&gp=0.jpg","https://img0.baidu.com/it/u=3114228356,677481409&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=508846955,3814747122&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=3536647690,3616605490&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=4087287201,1148061266&fm=26&fmt=auto&gp=0.jpg","https://img2.baidu.com/it/u=3429163260,2974496379&fm=26&fmt=auto&gp=0.jpg"]})};return(a,n)=>(h(),_(z(e),{title:z(t)("imageViewerDemo.imageViewer"),message:z(t)("imageViewerDemo.imageViewerDes")},{default:x((()=>[y(z(ie),{type:"primary",onClick:s},{default:x((()=>[te(se(z(t)("imageViewerDemo.open")),1)])),_:1})])),_:1},8,["title","message"]))}});export{ve as default};
